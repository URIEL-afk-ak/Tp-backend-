# =========================
# üöÄ API GATEWAY CONFIGURATION
# =========================

server.port=8080
spring.application.name=api-gateway

# =========================
# üîê SECURITY CONFIGURATION (Keycloak)
# =========================
spring.security.oauth2.resourceserver.jwt.issuer-uri=${KEYCLOAK_ISSUER_URI:http://localhost:8090/realms/tpi-realm}
spring.security.oauth2.resourceserver.jwt.connect-timeout=15000
spring.security.oauth2.resourceserver.jwt.read-timeout=15000

# =========================
# üõ£Ô∏è GATEWAY ROUTES CONFIGURATION (CORREGIDO CON DOBLE \\)
# =========================
spring.cloud.gateway.routes[0].id=backend-service-clientes
spring.cloud.gateway.routes[0].uri=${CLIENTES_URL:http://localhost:8081}
spring.cloud.gateway.routes[0].predicates[0]=Path=/clientes/**
spring.cloud.gateway.routes[0].filters[0]=RewritePath=/clientes(?<segment>/?.*), /api/clientes\\k<segment>

spring.cloud.gateway.routes[1].id=backend-service-contenedores
spring.cloud.gateway.routes[1].uri=${CONTENEDORES_URL:http://localhost:8082}
spring.cloud.gateway.routes[1].predicates[0]=Path=/contenedores/**
spring.cloud.gateway.routes[1].filters[0]=RewritePath=/contenedores(?<segment>/?.*), /api/contenedores\\k<segment>

spring.cloud.gateway.routes[2].id=backend-service-depositos
spring.cloud.gateway.routes[2].uri=${DEPOSITOS_URL:http://localhost:8083}
spring.cloud.gateway.routes[2].predicates[0]=Path=/depositos/**
spring.cloud.gateway.routes[2].filters[0]=RewritePath=/depositos(?<segment>/?.*), /api/depositos\\k<segment>

spring.cloud.gateway.routes[3].id=backend-service-estadias-dep
spring.cloud.gateway.routes[3].uri=${DEPOSITOS_URL:http://localhost:8083}
spring.cloud.gateway.routes[3].predicates[0]=Path=/estadias/**
spring.cloud.gateway.routes[3].filters[0]=RewritePath=/estadias(?<segment>/?.*), /api/estadias\\k<segment>

spring.cloud.gateway.routes[4].id=backend-service-facturacion
spring.cloud.gateway.routes[4].uri=${FACTURACION_URL:http://localhost:8084}
spring.cloud.gateway.routes[4].predicates[0]=Path=/facturas/**
spring.cloud.gateway.routes[4].filters[0]=RewritePath=/facturas(?<segment>/?.*), /api/facturas\\k<segment>

spring.cloud.gateway.routes[5].id=backend-service-tarifas
spring.cloud.gateway.routes[5].uri=${FACTURACION_URL:http://localhost:8084}
spring.cloud.gateway.routes[5].predicates[0]=Path=/tarifas/**
spring.cloud.gateway.routes[5].filters[0]=RewritePath=/tarifas(?<segment>/?.*), /api/tarifas\\k<segment>

spring.cloud.gateway.routes[6].id=backend-service-solicitudes
spring.cloud.gateway.routes[6].uri=${SOLICITUDES_URL:http://localhost:8085}
spring.cloud.gateway.routes[6].predicates[0]=Path=/solicitudes/**
spring.cloud.gateway.routes[6].filters[0]=RewritePath=/solicitudes(?<segment>/?.*), /api/solicitudes\\k<segment>

spring.cloud.gateway.routes[7].id=backend-service-rutas
spring.cloud.gateway.routes[7].uri=${RUTAS_TRAMOS_URL:http://localhost:8086}
spring.cloud.gateway.routes[7].predicates[0]=Path=/rutas/**
spring.cloud.gateway.routes[7].filters[0]=RewritePath=/rutas(?<segment>/?.*), /api/rutas\\k<segment>

spring.cloud.gateway.routes[8].id=backend-service-tramos
spring.cloud.gateway.routes[8].uri=${RUTAS_TRAMOS_URL:http://localhost:8086}
spring.cloud.gateway.routes[8].predicates[0]=Path=/tramos/**
spring.cloud.gateway.routes[8].filters[0]=RewritePath=/tramos(?<segment>/?.*), /api/tramos\\k<segment>

spring.cloud.gateway.routes[9].id=backend-service-distancia
spring.cloud.gateway.routes[9].uri=${RUTAS_TRAMOS_URL:http://localhost:8086}
spring.cloud.gateway.routes[9].predicates[0]=Path=/distancia/**
spring.cloud.gateway.routes[9].filters[0]=StripPrefix=0

spring.cloud.gateway.routes[10].id=backend-service-tracking
spring.cloud.gateway.routes[10].uri=${TRACKING_URL:http://localhost:8087}
spring.cloud.gateway.routes[10].predicates[0]=Path=/tracking/**
spring.cloud.gateway.routes[10].filters[0]=StripPrefix=0

spring.cloud.gateway.routes[11].id=backend-service-eventos
spring.cloud.gateway.routes[11].uri=${TRACKING_URL:http://localhost:8087}
spring.cloud.gateway.routes[11].predicates[0]=Path=/eventos/**
spring.cloud.gateway.routes[11].filters[0]=RewritePath=/eventos(?<segment>/?.*), /api/tracking/eventos\\k<segment>

spring.cloud.gateway.routes[12].id=backend-service-camiones
spring.cloud.gateway.routes[12].uri=${CAMIONES_URL:http://localhost:8088}
spring.cloud.gateway.routes[12].predicates[0]=Path=/camiones/**
spring.cloud.gateway.routes[12].filters[0]=RewritePath=/camiones(?<segment>/?.*), /api/camiones\\k<segment>

spring.cloud.gateway.routes[13].id=backend-service-transportistas
spring.cloud.gateway.routes[13].uri=${CAMIONES_URL:http://localhost:8088}
spring.cloud.gateway.routes[13].predicates[0]=Path=/transportistas/**
spring.cloud.gateway.routes[13].filters[0]=RewritePath=/transportistas(?<segment>/?.*), /api/transportistas\\k<segment>

# =========================
# üîó MICROSERVICE URLs FOR RutasService
# =========================
microservice.camiones.url=${MICROSERVICE_CAMIONES_URL:http://localhost:8088}/api
microservice.contenedores.url=${MICROSERVICE_CONTENEDORES_URL:http://localhost:8082}/api

# =========================
# üìä LOGGING CONFIGURATION
# =========================
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.cloud.gateway=DEBUG

# =========================
# OPENAPI / SWAGGER
# =========================
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.urls-primary-name=API Gateway
